{% extends 'base.html.twig' %}

{% block title %}
	{{ title }}
{% endblock %}

{% block styles %}
	<style>
		.dashboard-container {
			max-width: 1200px;
			margin: 2rem auto;
			padding: 0 1rem;
		}

		.welcome-card {
			background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
			color: white;
			border-radius: 20px;
			padding: 2rem;
			margin-bottom: 2rem;
			box-shadow: 0 10px 40px rgba(102, 126, 234, 0.3);
		}

		.welcome-card h1 {
			margin: 0 0 0.5rem;
			font-size: 2rem;
		}

		.welcome-card p {
			margin: 0;
			opacity: 0.9;
		}

		.action-buttons {
			display: flex;
			gap: 1rem;
			margin-bottom: 2rem;
		}

		.btn {
			padding: 0.875rem 1.5rem;
			border-radius: 10px;
			text-decoration: none;
			font-weight: 600;
			transition: transform 0.3s, box-shadow 0.3s;
			display: inline-block;
		}

		.btn-primary {
			background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
			color: white;
		}

		.btn-primary:hover {
			transform: translateY(-2px);
			box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
		}

		.teens-grid {
			display: grid;
			grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
			gap: 1.5rem;
		}

		.teen-card {
			background: white;
			border-radius: 15px;
			padding: 1.5rem;
			box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
			transition: transform 0.3s;
		}

		.teen-card:hover {
			transform: translateY(-5px);
			box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
		}

		.teen-header {
			display: flex;
			align-items: center;
			gap: 1rem;
			margin-bottom: 1rem;
		}

		.teen-avatar {
			width: 60px;
			height: 60px;
			border-radius: 50%;
			background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 1.5rem;
		}

		.teen-info h3 {
			margin: 0;
			color: #333;
			font-size: 1.25rem;
		}

		.teen-info p {
			margin: 0.25rem 0 0;
			color: #666;
			font-size: 0.9rem;
		}

		.balance {
			background: #f0f4ff;
			border-radius: 10px;
			padding: 1rem;
			margin: 1rem 0;
			text-align: center;
		}

		.balance-label {
			font-size: 0.875rem;
			color: #666;
			margin-bottom: 0.25rem;
		}

		.balance-amount {
			font-size: 1.75rem;
			font-weight: 700;
			color: #667eea;
		}

		.empty-state {
			text-align: center;
			padding: 3rem;
			background: white;
			border-radius: 15px;
		}

		.empty-state-icon {
			font-size: 4rem;
			margin-bottom: 1rem;
		}

		.empty-state h2 {
			color: #333;
			margin-bottom: 0.5rem;
		}

		.empty-state p {
			color: #666;
			margin-bottom: 1.5rem;
		}

		.alert {
			padding: 1rem;
			border-radius: 10px;
			margin-bottom: 1rem;
			font-weight: 600;
		}

		.alert-success {
			background-color: #d4edda;
			color: #155724;
		}

		.alert-danger {
			background-color: #f8d7da;
			color: #721c24;
		}
	</style>
{% endblock %}

{% block content %}
	<div class="dashboard-container">
		<div class="welcome-card">
			<h1>ðŸ‘‹ Bonjour
				{{ session.user_name }}
				!</h1>
			<p>Bienvenue sur votre tableau de bord parent</p>
		</div>

		{% if session.success_message %}
			<div class="alert alert-success">
				{{ session.success_message }}
			</div>
		{% endif %}

		{% if session.error_message %}
			<div class="alert alert-danger">
				{{ session.error_message }}
			</div>
		{% endif %}

		<div class="action-buttons">
			<a href="/parent/teen/create" class="btn btn-primary">
				âž• Inscrire un adolescent
			</a>
		</div>

		{% if teens is empty %}
			<div class="empty-state">
				<div class="empty-state-icon">ðŸ§’</div>
				<h2>Aucun adolescent inscrit</h2>
				<p>Commencez par inscrire votre premier adolescent pour gÃ©rer son argent de poche</p>
				<a href="/parent/teen/create" class="btn btn-primary">
					Inscrire un adolescent
				</a>
			</div>
		{% else %}
			<div class="teens-grid">
				{% for teen in teens %}
					<div class="teen-card">
						<div class="teen-header">
							<div class="teen-avatar">ðŸ§’</div>
							<div class="teen-info">
								<h3>{{ teen.firstname }}
									{{ teen.lastname }}</h3>
								<p>@{{ teen.username }}</p>
								<p>{{ teen.age }}
									ans</p>
								<p>{{ teen.weekly_allowance|number_format(2, ',', ' ') }}
									â‚¬/semaine</p>
							</div>
						</div>

						<div class="balance">
							<div class="balance-label">Solde actuel</div>
							<div class="balance-amount">{{ teen.balance|number_format(2, ',', ' ') }}
								â‚¬</div>
						</div>

						<form method="POST" action="/parent/teen/{{ teen.id }}/update-balance" style="margin-top: 1rem;">
							<div style="display: flex; gap: 0.5rem; align-items: center;">
								<input type="number" name="balance" step="0.01" min="0" value="{{ teen.balance }}" style="flex: 1; padding: 0.5rem; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 0.9rem;" placeholder="Nouveau solde" required>
								<button type="submit" style="padding: 0.5rem 1rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 0.875rem;">
									ðŸ’° Modifier
								</button>
							</div>
						</form>

						<form method="POST" action="/parent/teen/{{ teen.id }}/update-weekly-allowance" style="margin-top: 0.5rem;">
							<div style="display: flex; gap: 0.5rem; align-items: center;">
								<input type="number" name="weekly_allowance" step="0.01" min="0" value="{{ teen.weekly_allowance }}" style="flex: 1; padding: 0.5rem; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 0.9rem;" placeholder="Argent de poche/semaine" required>
								<button type="submit" style="padding: 0.5rem 1rem; background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 0.875rem;">
									ðŸ“… Modifier
								</button>
							</div>
						</form>
					</div>
				{% endfor %}
			</div>
		{% endif %}
	</div>
{% endblock %}
